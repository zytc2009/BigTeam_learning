## 一、色彩空间

**RGB**：是红、绿、蓝三原色，任何颜色都可以通过这三原色按不同比例混合出来。但在科学研究一般不采用RGB颜色空间，因为它的细节难以进行数字化的调整。它将亮度、色调、饱和度三个量放在一起表示，很难分开。

**YUV**：在 YUV 空间中，每一个颜色有一个亮度信号 Y（或称灰阶值），和两个色度信号 U 和 V。亮度信号是强度的感觉，它和色度信号断开，这样的话强度就可以在不影响颜色的情况下改变。此外，我们平常所说的YUV实际是YCbCr，它是YUV的其中一种格式，应用于计算机等显示器设备。这里，YCbCr其中Y是指亮度分量，Cb指蓝色色度分量，而Cr指红色色度分量。接下来文中提到的YUV默认为YCbCr。

## 二、图像格式

#### 1、RGB格式

**RGB_565**：用16个bit表示一个像素，5个bit表示R(红色)，6个bit表示G(绿色)，5个bit表示B(蓝色)，那么一个屏幕像素点占5+6+5=16位，共2个字节。

**RGB_555**：用16个bit表示一个像素，最高位不用，5个bit表示R(红色)，5个bit表示G(绿色)，5个bit表示B(蓝色)，那么一个屏幕像素点占1+5+5+5=16位，共2个字节。

**ARGB_8888**：用32个bit表示一个像素，8个bit表示A(透明度)， 8个bit表示R(红色)，8个bit表示G(绿色)，8个bit表示B(蓝色) ，那么一个屏幕像素点占8+8+8+8=32位，共4个字节。

**ARGB_4444**：用16个bit表示一个像素，4个bit表示A(透明度)， 4个bit表示R(红色)，4个bit表示G(绿色)，4个bit表示B(蓝色) ，那么一个屏幕像素点占4+4+4+4=16位，共2个字节。

#### 2、YUV格式

- **采样格式**

   人眼对亮度(Y分量)的敏感度远远大于颜色(UV分量)的敏感度，所以丢弃某些UV分量，图像在肉眼中的感觉不会起太大的变化，主流的采样方式有四种，分别为YUV4:4:4，YUV4:2:2，YUV4:1:1，YUV4:2:0。

- **存储格式**

 **Planar平面格式**：指先连续存储所有像素点的 Y 分量，然后存储 U 、V 分量。

 **Packed打包格式**：指每个像素点的 Y、U、V 分量是连续交替存储的。

 我们常说的YUV图像格式都是由采样格式+存储格式组合而成的，如NV21、YV12、I420、YUY2等。

![avatar](image\yuv格式说明.png)

注：YUV420P：先存储所有的 Y分量、接着U 分量、最后 V 分量；YUV420SP：先存储所有的 Y分量，接着按照 UV 或者 VU 的交替顺序进行存储；

下面分别介绍下YUV各种采样格式，以4*4的像素块举例：

- **YUV4:4:4**

 YUV三个信道的抽样率相同，每个像素点的三个分量信息完整，每个分量用8bit表示，平均一个像素点占用3个字节。

![avatar](image\yuv444.png)

假如图像像素为：[Y0 U0 V0]、[Y1 U1 V1]、[Y2 U2 V2]、[Y3 U3 V3]

那么采样的码流为：Y0 U0 V0 Y1 U1 V1 Y2 U2 V2 Y3 U3 V3

最后映射出的像素点依旧为： [Y0 U0 V0]、[Y1 U1 V1]、[Y2 U2 V2]、[Y3 U3 V3]

- **YUV4:2:2**

 U、V分量是Y分量的抽样率一半，每个像素点对应一个Y分量，水平方向每两个相邻像素点，抽取第一个像素点的U分量，抽取第二个像素点的V分量，则平均一个像素点占用2个字节。

![avatar](image\yuv422.png)

假如图像像素为：[Y0 U0 V0]、[Y1 U1 V1]、[Y2 U2 V2]、[Y3 U3 V3]

那么采样的码流为：Y0 U0 Y1 V1 Y2 U2 Y3 V3

其中，每采样过一个像素点，都会采样其 Y 分量，而 U、V 分量就会间隔一个采集一个

最后映射出的像素点为 [Y0 U0 V1]、[Y1 U0 V1]、[Y2 U2 V3]、[Y3 U2 V3]

- **YUV4:1:1**

 U、V分量是Y分量的抽样率1/4，每个像素点对应一个Y分量，水平方向每四个相邻像素点，抽取第一个像素点的U分量，抽取第三个像素点的V分量，则平均一个像素点占用1.5个字节。

![avatar](image\yuv411.png)

假如图像像素为：[Y0 U0 V0]、[Y1 U1 V1]、[Y2 U2 V2]、[Y3 U3 V3]

那么采样的码流为：Y0 U0 Y1 Y2 V2 Y3

最后映射出的像素点为 ：[Y0 U0 V2]、 [Y1 U0 V2] 、[Y2 U0 V2]、 [Y3 U0 V2]

- **YUV4:2:0**

 U、V分量是Y分量的抽样率1/4，每个像素点对应一个Y分量，按行扫描，相邻两行中第一行每2个相邻像素点抽取第一个像素点的U分量，第二行每2个相邻像素点抽取第一个像素点的V分量，则平均一个像素点占用1.5个字节。

![avatar](image\yuv420.png)

假设图像像素为：

[Y0 U0 V0]、[Y1 U1 V1]、 [Y2 U2 V2]、 [Y3 U3 V3]

[Y4 U4 V4]、[Y5 U5 V5]、[Y6 U6 V6]、 [Y7 U7 V7]

那么采样的码流为：Y0 U0 Y1 Y2 U2 Y3 Y4 V4 Y5 Y6 V6 Y7

其中，每采样过一个像素点，都会采样其 Y 分量，而 U、V 分量就会间隔一行按照 2 : 1 进行采样

最后映射出的像素点为：

[Y0 U0 V5]、[Y1 U0 V5]、[Y2 U2 V7]、[Y3 U2 V7]

[Y5 U0 V5]、[Y6 U0 V5]、[Y7 U2 V7]、[Y8 U2 V7]

## 三、格式转换

![avatar-w571](image\rgb2yuv.png)

## 四、图像封装格式

- **jpg/jpeg**

   采用有损压缩的图片格式，利用人眼对光线的敏感度比对颜色的敏感度要高，当颜色缺失时人脑会利用与附近最接近的颜色来自动填补缺失的颜色，压缩存储时去掉那些图像上会被人眼忽略的细节，显示时使用附近的颜色通过渐变或其他形式进行填充。**适合摄影图像或写实图像的高级压缩存储。**

- **png**

   采用无损压缩的图片格式，在存储图像前会先判断图像上哪些地方是相同的哪些地方是不同的，并对图像上所有出现的颜色进行索引，存储时用索引色值代替原色值。根据索引色数量不同可分为png8与png24，“8”代表2的8次方索引色，“24”代表2的24方索引色。**适合较大亮度差异以及强烈对比的简单图像的压缩存储。**

- **gif**

   是基于颜色列表的（存储的数据是该点的颜色对应于颜色列表的索引值），最多只支持8位（256色）。GIF文件内部分成许多存储块，用来存储多幅图象或者是决定图象表现行为的控制块，用以实现动画和交互式应用。